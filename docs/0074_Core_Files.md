# Core Files

经过和颖奇讨论，这个主要是应用程序Crash的时候，会自动保存堆载信息，便于调试；

## 参考文档

* [Core Files on the Raspberry Pi](https://docs.faircom.com/doc/knowledgebase/76189.htm)
* [详解coredump](https://blog.csdn.net/MOU_IT/article/details/88903668)

## 测试代码

* https://github.com/ZengjfOS/RaspberryPi/tree/coredump

## steps

* ulimit -c
  ```
  0
  ```
* ulimit -a
  ```
  core file size          (blocks, -c) 0
  data seg size           (kbytes, -d) unlimited
  scheduling priority             (-e) 0
  file size               (blocks, -f) unlimited
  pending signals                 (-i) 30311
  max locked memory       (kbytes, -l) unlimited
  max memory size         (kbytes, -m) unlimited
  open files                      (-n) 1024
  pipe size            (512 bytes, -p) 8
  POSIX message queues     (bytes, -q) 819200
  real-time priority              (-r) 95
  stack size              (kbytes, -s) 8192
  cpu time               (seconds, -t) unlimited
  max user processes              (-u) 30311
  virtual memory          (kbytes, -v) unlimited
  file locks                      (-x) unlimited
  ```
* ulimit -c unlimited
* ulimit -c
  ```
  unlimited
  ```
* ulimit -a
  ```
  core file size          (blocks, -c) unlimited
  data seg size           (kbytes, -d) unlimited
  scheduling priority             (-e) 0
  file size               (blocks, -f) unlimited
  pending signals                 (-i) 30311
  max locked memory       (kbytes, -l) unlimited
  max memory size         (kbytes, -m) unlimited
  open files                      (-n) 1024
  pipe size            (512 bytes, -p) 8
  POSIX message queues     (bytes, -q) 819200
  real-time priority              (-r) 95
  stack size              (kbytes, -s) 8192
  cpu time               (seconds, -t) unlimited
  max user processes              (-u) 30311
  virtual memory          (kbytes, -v) unlimited
  file locks                      (-x) unlimited
  ```
* sudo su
* echo 1 > /proc/sys/kernel/core_uses_pid
* exit
* make
* ./main
* ls
  ```
  core.5871  main  main.c  Makefile
  ```
* gdb main core.5871
  ```gdb
  GNU gdb (Raspbian 8.2.1-2) 8.2.1
  Copyright (C) 2018 Free Software Foundation, Inc.
  License GPLv3+: GNU GPL version 3 or later <http://gnu.org/licenses/gpl.html>
  This is free software: you are free to change and redistribute it.
  There is NO WARRANTY, to the extent permitted by law.
  Type "show copying" and "show warranty" for details.
  This GDB was configured as "arm-linux-gnueabihf".
  Type "show configuration" for configuration details.
  For bug reporting instructions, please see:
  <http://www.gnu.org/software/gdb/bugs/>.
  Find the GDB manual and other documentation resources online at:
      <http://www.gnu.org/software/gdb/documentation/>.
  
  For help, type "help".
  Type "apropos word" to search for commands related to "word"...
  Reading symbols from main...done.
  [New LWP 5871]
  Core was generated by `./main'.
  Program terminated with signal SIGSEGV, Segmentation fault.
  #0  0x00010538 in main () at main.c:28
  28          *ptr = 10;
  (gdb) quit
  ```